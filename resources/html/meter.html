<!DOCTYPE html><html class=''>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Pragma" content="no-cache">
<title>ESPEM - PowerMeter stat page</title>

<link type="text/css" rel="stylesheet" href="css/meterstyle.css">

<script src='js/modernizr-custom.js' type='text/javascript'></script>
<script type='text/javascript'>
    try { Modernizr } catch(e) { document.write('<script src="https://modernizr.com/download/?-cssall-cssfilters-csstransforms-csstransforms3d-csstransitions-textalignlast-wrapflow-setclasses"><\/script>')
    console.log("CDN Modernizer loaded!"); }
</script>

<!--Chart Styles -->
<style>
#chartdiv {
    width               : 100%;
    height              : 500px;
    font-size   : 11px;
}
</style>

<!-- amCharts javascript sources -->
<script src="http://www.amcharts.com/lib/3/amcharts.js" type="text/javascript"></script>
<script src="http://www.amcharts.com/lib/3/serial.js" type="text/javascript"></script>
<script src="http://www.amcharts.com/lib/3/themes/dark.js" type="text/javascript"></script>
<script src="http://www.amcharts.com/lib/3/themes/black.js" type="text/javascript"></script>
<script src="http://cdn.amcharts.com/lib/3/gauge.js" type="text/javascript"></script>
<!-- amCharts plugins -->
<script src="http://www.amcharts.com/lib/3/plugins/export/export.min.js" type="text/javascript"></script>
<script src="http://www.amcharts.com/lib/3/plugins/dataloader/dataloader.min.js" type="text/javascript"></script>

<link href="http://www.amcharts.com/lib/3/plugins/export/export.css" rel="stylesheet">


<!-- amCharts - Voltage Gauge -->
<script type="text/javascript">
    AmCharts.makeChart("GaugeV", 
    {
    "type": "gauge",
    "marginBottom": 5,
    "marginTop": 5,
    "startDuration": 2,
    "accessible": false,
    "fontSize": 13,
    "theme": "dark",
    "creditsPosition": "bottom-left",
    "arrows": [
        {
            "id": "Voltage",
            "innerRadius": "70%",
    	    "radius": "105%",
            "startWidth": 8,
            "value": 100
        }
    ],
    "axes": [
        {
            "axisThickness": 1,
            "topText": "42 V",
            "topTextYOffset": 30,
            "bottomText": "=Voltage=",
    	    "bottomTextYOffset": 5,
            "endValue": 260,
            "fontSize": 14,
            "id": "voltage-last",
            "startValue": 190,
            "valueInterval": 10,
            "bands": [
            {
                "alpha": 0.7,
                "color": "#00CC00",
                "endValue": 240,
                "id": "NormalV",
                "startValue": 210
                },
            {
                "alpha": 0.7,
                "color": "#ffac29",
                "endValue": 210,
                "id": "lowV",
                "startValue": 190
            },
            {
                "alpha": 0.7,
                "color": "#EA3838",
                "endValue": 260,
                "gradientRatio": [],
                "id": "HighV",
                "innerRadius": "95%",
                "startValue": 240
            }
            ]
        }
    ],
    "allLabels": [],
    "balloon": {},
    "titles": []
}

    
    );
</script>


<!-- amCharts - PF Gauge -->
<script type="text/javascript">
    AmCharts.makeChart("GaugePF", {include file="chartPFGauge.json.tpl"} );
</script>

<!-- amCharts - Samples minichart -->
<script type="text/javascript">
    AmCharts.makeChart("SamplesMini", 
    
    {
    "type": "serial",
    "dataLoader": {
        "url": "http://espemtst/samples"
    },
    "categoryField": "t",
    "sequencedAnimation": false,
    "startDuration": 2,
    "startEffect": "easeOutSine",
    "backgroundColor": "#000000",
    "borderColor": "#111111",
    "theme": "black",
    "creditsPosition": "bottom-right",
    "categoryAxis": {
	"gridPosition": "start",
	"minPeriod": "ss",
	"parseDates": true
    },
    "graphs": [
	{
	    "id": "gPWR",
	    "lineColor": "#FF0000",
	    "lineThickness": 2,
	    "title": "{$msg_stat.power|capitalize}",
	    "type": "step",
	    "valueAxis": "vaP",
	    "valueField": "P"
	},
	{
	    "id": "gPF",
	    "lineColor": "#23EF23",
	    "lineThickness": 2,
	    "title": "{$msg_stat.PowerFactor|capitalize}",
	    "type": "smoothedLine",
	    "valueAxis": "vaPF",
	    "valueField": "pF"
	}
    ],
    "valueAxes": [
	{
	    "id": "vaP",
	    "unit": "{$msg_stat.P}",
	    "axisColor": "#FF0000",
	    "axisThickness": 2,
	    "color": "#FF0000",
	    "dashLength": 0
	},
	{
	    "id": "vaPF",
	    "maximum": 1,
	    "minimum": 0,
	    "position": "right",
	    "strictMinMax": true,
	    "color": "#23EF23"
	}
    ],
    "legend": {
	"enabled": false
    },
    "export": {
	"enabled": false
    }
}
    
    
    );
</script>


<!-- amCharts Daily stat for 1 month graph -->

</head>
<body>

<p class="header-title center">Энергометр - Статистика</p>
<br>

<div id="mainpage" style="width: 95%; position:relative; margin: auto;" >

<div class="statusMenu">
    <div class="item sel">
        <form action="" method="get">
        <select name="devid" id="devselect" onchange="this.form.submit()">
        {foreach key=row item=data from=$devlist}
        <option {if $data.id eq $devid}selected{/if} value="{$data.id}">{$data.name}</option>
        {/foreach}
        </select></form>
    </div>
    <div class="item"><label for="inpgr">Graphs</label></div>
    <div class="item"><label for="inptbl">Tables</label></div>
    <div class="item"><a class="menu" href="?s=psamples&devid={$devid}">Samples</a></div>
</div>

<input type="checkbox" id="inpgr" class="hidden">
<div id="Gauges" class="graphs" >
    <div id="GaugeV"  class="graph" style="float:left; width: 200px; height: 180px; " ></div>
    <div id="GaugePF" class="graph" style="width: 250px; height: 160px; " ></div>
    <div id="SamplesMini" class="graph" style="flex: 1; height: 180px;" ></div>
</div>

<br>

<div id="monthstat" class="graphs" style="width: 99%; height: 400px; " ></div>

<div id="stat" style="clear:both; margin: 0 auto;">

<input type="checkbox" id="inptbl" class="hidden" checked>
<div id="stattables">
<p class="page-text">Расход электроэнергии по месяцам</p>

<table class="table table-header-rotated center">
<thead><tr>
{foreach key=hdr item=noitem from=$ystat[0]}
    <th class="rotate"><div><span>{$msg_stat.$hdr}</span></div></th>
{/foreach}
</tr></thead>
<tbody>
{foreach key=row item=data from=$ystat}
    <tr>
	{foreach key=hdr item=val from=$data}
	    <td>{$val}</td>
	{/foreach}
    </tr>
{/foreach}
</tbody>
</table>

</div>


</div>
</div>

</body>
</html>